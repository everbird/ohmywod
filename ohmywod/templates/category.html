{% extends "base.html" %}

{% block title %}战报 - {{ category.name }}{% endblock %}

{% block head %}
    {{ super() }}
<link href="https://unpkg.com/filepond@^4/dist/filepond.css" rel="stylesheet" />
<style type="text/css">
    #report-breadcrumb ol {
        border-radius: 0px;
    }

    .breadcrumb-item {
        max-width: 40%;
    }

    .pond {
        width:100%;
        padding-left: 15px;
        padding-right: 15px;
        padding-bottom: 15px;
        margin:0 auto;
        opacity:0;
        transition:opacity 1s .25s
    }

    .pond .filepond--drop-label {
        color:#c7ccd8
    }
    .pond .filepond--panel-root {
        background-color:transparent;
        border:2px solid #2c3340
    }
    .pond .filepond--item-panel {
        background-color:#767b8b
    }
    .pond .filepond--file-action-button {
        background-color:rgba(31,37,49,.85)
    }
    .pond [data-filepond-item-state=processing-complete] .filepond--item-panel {
        background-color:#22a061
    }
    .pond [data-filepond-item-state*=error] .filepond--item-panel,
    .pond [data-filepond-item-state*=invalid] .filepond--item-panel {
        background-color:#d04535
    }
    
</style>
{% endblock %}

{% block content %}
<nav id="report-breadcrumb" aria-label="breadcrumb">
  <ol class="breadcrumb">
      <li class="breadcrumb-item">
         <a href="/r/">目录</a>
      </li>
      <li class="breadcrumb-item active text-truncate" aria-current="page">
          {{ category.name }}
      </li>
  </ol>
</nav>
{% if current_user.username == category.owner %}
<div class="pond" style="opacity: 1;">
    <input id="mypond" type="file" style="opacity: 1;"/>
</div>
{% endif %}
{% if category.reports %}
<table class="table table-striped table-dark">
    <thead>
        <tr>
            <th scope="col">Id</th>
            <th scope="col">Name</th>
            <th scope="col">Description</th>
        </tr>
    </thead>
    <tbody>
    {% for r in category.reports %}
        <tr>
            <th scope="row">{{ r.id }}</th>
            <td><a href="{{ url_for('wodreport.view_report', report_id=r.id) }}">{{ r.name }}</a></td>
            <td>{{ r.description  }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}

{% endif %}

{% endblock %}

{% block footer %}
    <script src="https://unpkg.com/filepond@^4/dist/filepond.js"></script>
    {{ super() }}

    <script src="https://unpkg.com/jquery-filepond/filepond.jquery.js"></script>

{% if current_user.username == category.owner %}
<script>
$("input").filepond({
    allowMultiple: true,
    allowRevert: false,
    allowRemove: false,
    server: {
        process: '{{ url_for('upload.process', category_id=category.id) }}',
    },
})
{% endif %}
</script>
{% endblock %}
